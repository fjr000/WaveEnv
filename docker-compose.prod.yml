version: '3.8'

# 生产环境 Docker Compose 配置
# 使用方式: docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

services:
  backend:
    # 生产环境不挂载代码目录
    # volumes: []
    # 添加生产环境特定的环境变量
    environment:
      - PYTHONUNBUFFERED=1
      - LOG_LEVEL=INFO
      # 生产环境建议设置具体值，而不是使用默认值
    # 生产环境资源限制
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
        reservations:
          cpus: '1'
          memory: 1G
    # 生产环境重启策略
    restart: always

  frontend:
    # 生产环境不挂载代码目录
    # volumes: []
    # 生产环境资源限制
    deploy:
      resources:
        limits:
          cpus: '1'
          memory: 1G
        reservations:
          cpus: '0.5'
          memory: 512M
    # 生产环境重启策略
    restart: always

